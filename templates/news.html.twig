{% extends 'base.html.twig' %}

{% block body %}

<div class="flex h-screen w-full">
    {% include 'components/sidebar.html.twig' %}

    <div class="w-full h-full overflow-y-auto">
        <div class="bg-gray-900 min-h-screen text-white p-6 relative">
            <div class="max-w-3xl mx-auto">
                {# √î ƒëƒÉng tr·∫°ng th√°i #}
                <div class="bg-gray-800 p-4 rounded-lg shadow-md mb-4">
                    <div class="flex items-center space-x-3">
                        <img src="{{ profile.avatar }}" class="w-10 h-10 rounded-full border border-gray-700">
                        <input type="text" placeholder="{{ profile.name }} ∆°i, b·∫°n ƒëang nghƒ© g√¨ th·∫ø?"
                               class="flex-1 bg-gray-700 text-white p-2 rounded-full outline-none placeholder-gray-400 cursor-pointer"
                               id="openModal">
                    </div>
                </div>

                <div id="postModal" class="fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden z-[99999]">
                    <div class="bg-gray-800 p-6 rounded-lg shadow-lg w-96 relative z-[99999]">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-white text-lg font-semibold">T·∫°o b√†i vi·∫øt</h2>
                            <button id="closeModal" class="text-gray-400 hover:text-white text-xl">‚úñ</button>
                        </div>

                        <!-- N·ªôi dung nh·∫≠p TinyMCE -->
                        <textarea id="postContent"></textarea>

                        <!-- N√∫t ƒëƒÉng b√†i -->
                        <div class="flex justify-end mt-4">
                            <button class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg">
                                ƒêƒÉng b√†i
                            </button>
                        </div>
                    </div>
                </div>

                {# Danh s√°ch b·∫°n b√® #}
                <div class="flex space-x-4 overflow-x-auto p-2 justify-center">
                    {# H·ªì s∆° c·ªßa b·∫°n - Hi·ªÉn th·ªã avatar #}
                    <div class="relative w-28 h-48 bg-gray-800 rounded-xl overflow-hidden flex flex-col justify-end">
                        <img src="{{ profile.avatar }}" class="absolute top-0 w-full h-full object-cover opacity-50">
                        <div class="flex flex-col items-center p-2 relative">
                            <button class="bg-blue-500 w-8 h-8 rounded-full flex items-center justify-center border-4 border-gray-800">
                                +
                            </button>
                            <p class="text-xs mt-1">H·ªì s∆° c·ªßa b·∫°n</p>
                        </div>
                    </div>

                    {# Danh s√°ch b·∫°n b√® #}
                    {% for friend in friendList %}
                        <div class="relative w-28 h-48 bg-gray-800 rounded-xl overflow-hidden">
                            <img src="{{ friend.avatar }}" class="w-full h-full object-cover">
                            {# Avatar b·∫°n b√® #}
                            <div class="absolute top-2 left-2 w-10 h-10 border-4 border-gray-900 rounded-full overflow-hidden">
                                <img src="{{ friend.avatar }}" class="w-full h-full object-cover">
                            </div>
                            {# T√™n b·∫°n b√® #}
                            <div class="absolute bottom-2 left-2 text-sm font-semibold">
                                {{ friend.name }}
                            </div>
                        </div>
                    {% endfor %}

                    {# N√∫t b·∫•m cu·ªôn ngang #}
                    <button class="absolute right-2 top-1/2 transform -translate-y-1/2 bg-gray-800 p-2 rounded-full shadow-md hover:bg-gray-700">
                        ‚Üí
                    </button>
                </div>

            </div>
                {#Danh s√°ch b√†i vi·∫øt#}
                <div class="bg-gray-900 min-h-screen text-white p-6 h-full">
                    <div class="max-w-2xl mx-auto bg-gray-800 p-4 rounded-lg shadow-lg">

                        {# Header b√†i ƒëƒÉng #}
                        <div class="flex items-center space-x-3">
                            <img src="{{ post.page_avatar }}" class="w-10 h-10 rounded-full">
                            <div>
                                <p class="font-semibold">{{ post.page_name }}</p>
                                <p class="text-sm text-gray-400">{{ post.time }} ‚Ä¢ üåç</p>
                            </div>
                        </div>

                        {# N·ªôi dung b√†i ƒëƒÉng #}
                        <div class="mt-3 text-gray-300">
                            {% for line in post.content %}
                                <p>{{ line }}</p>
                            {% endfor %}
                            <a href="#" class="text-blue-400 hover:underline">Xem th√™m</a>
                        </div>

                        {# H√¨nh ·∫£nh #}
                        <div class="mt-3 rounded-lg overflow-hidden">
                            <img src="{{ post.image }}" class="w-full h-auto object-cover">
                        </div>

                        {# B·∫£ng x·∫øp h·∫°ng #}
                        <div class="bg-gray-700 p-4 mt-3 rounded-lg">
                            <h3 class="text-lg font-semibold">üèÜ Saudi Pro League - B·∫£ng x·∫øp h·∫°ng</h3>
                            <table class="w-full mt-2">
                                <thead class="text-gray-400 text-sm">
                                <tr>
                                    <th class="text-left">#</th>
                                    <th class="text-left">ƒê·ªôi</th>
                                    <th class="text-center">Tr·∫≠n</th>
                                    <th class="text-center">HS</th>
                                    <th class="text-center">ƒêi·ªÉm</th>
                                </tr>
                                </thead>
                                <tbody class="text-gray-200">
                                {% for team in post.league_table %}
                                    <tr class="border-t border-gray-600">
                                        <td class="py-2">{{ team.rank }}</td>
                                        <td class="py-2 font-semibold">{{ team.name }}</td>
                                        <td class="py-2 text-center">{{ team.matches }}</td>
                                        <td class="py-2 text-center">{{ team.goal_difference }}</td>
                                        <td class="py-2 text-center font-bold">{{ team.points }}</td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>

                        {# L∆∞·ª£t th√≠ch, b√¨nh lu·∫≠n, chia s·∫ª #}
                        <div class="flex justify-between items-center mt-3 text-gray-400 text-sm">
                            <div class="flex items-center space-x-2">
                                <span>üëç üòÜ</span>
                                <span>{{ post.likes }} l∆∞·ª£t th√≠ch</span>
                            </div>
                            <div>
                                <span>{{ post.comments }} b√¨nh lu·∫≠n ‚Ä¢ {{ post.shares }} chia s·∫ª</span>
                            </div>
                        </div>

                        {# N√∫t t∆∞∆°ng t√°c #}
                        <div class="flex justify-between mt-2 border-t border-gray-600 pt-2">
                            <button class="flex-1 flex items-center justify-center py-2 rounded-lg hover:bg-gray-700 transition">
                                üëç Th√≠ch
                            </button>
                            <button class="flex-1 flex items-center justify-center py-2 rounded-lg hover:bg-gray-700 transition">
                                üí¨ B√¨nh lu·∫≠n
                            </button>
                            <button class="flex-1 flex items-center justify-center py-2 rounded-lg hover:bg-gray-700 transition">
                                üîÑ Chia s·∫ª
                            </button>
                        </div>

                    </div>
                </div>
                </div>
            </div>
        </div>

    <style>
        #postModal {
            z-index: 99999 !important; /* ƒê·∫£m b·∫£o modal lu√¥n n·∫±m tr√™n c√πng */
        }

        .tox-tinymce {
            z-index: 9999 !important; /* TinyMCE kh√¥ng ƒë∆∞·ª£c cao h∆°n modal */
        }

    </style>

    <!-- Script TinyMCE v√† Modal -->
    <script src="https://cdn.tiny.cloud/1/4ap6sni821pn56o84cses0860nmtuvurlwoxovop0j9t37j5/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Kh·ªüi t·∫°o TinyMCE
            tinymce.init({
                selector: '#postContent',
                menubar: false,
                plugins: 'autolink lists link image charmap preview',
                toolbar: 'undo redo | bold italic | alignleft aligncenter alignright | bullist numlist outdent indent',
                skin: "oxide-dark",
                content_css: "dark",
                setup: function (editor) {
                    editor.on('focus', function () {
                        document.getElementById("postModal").classList.add("z-[9999]");
                    });
                }
            });

            // Modal
            const modal = document.getElementById("postModal");
            const openModal = document.getElementById("openModal");
            const closeModal = document.getElementById("closeModal");

            openModal.addEventListener("click", function () {
                modal.classList.remove("hidden");
            });

            closeModal.addEventListener("click", function () {
                modal.classList.add("hidden");
            });

            // ƒê√≥ng modal khi click ra ngo√†i
            modal.addEventListener("click", function (e) {
                if (e.target === modal) {
                    modal.classList.add("hidden");
                }
            });
        });
    </script>
{% endblock %}
